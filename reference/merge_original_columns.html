<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Merge Original Data Columns with Temporal Segments — merge_original_columns • vecshift</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Merge Original Data Columns with Temporal Segments — merge_original_columns"><meta name="description" content="Enriches vecshift output by merging additional columns from the original
contract data. This function allows you to carry forward metadata and
additional attributes from the original employment contracts into the
temporal segments created by vecshift()."><meta property="og:description" content="Enriches vecshift output by merging additional columns from the original
contract data. This function allows you to carry forward metadata and
additional attributes from the original employment contracts into the
temporal segments created by vecshift()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vecshift</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/understanding-date-logic.html">Understanding Date Logic</a></li>
    <li><a class="dropdown-item" href="../articles/status-classification.html">Employment Status Classification</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/vecshift/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Merge Original Data Columns with Temporal Segments</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/vecshift/blob/main/R/merge_columns.R" class="external-link"><code>R/merge_columns.R</code></a></small>
      <div class="d-none name"><code>merge_original_columns.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Enriches vecshift output by merging additional columns from the original
contract data. This function allows you to carry forward metadata and
additional attributes from the original employment contracts into the
temporal segments created by vecshift().</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">merge_original_columns</span><span class="op">(</span><span class="va">original_data</span>, <span class="va">segments</span>, <span class="va">columns</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-original-data">original_data<a class="anchor" aria-label="anchor" href="#arg-original-data"></a></dt>
<dd><p>A data.table containing the original contract records
that were processed by vecshift(). Must include 'id' column and the
columns specified in the 'columns' parameter.</p></dd>


<dt id="arg-segments">segments<a class="anchor" aria-label="anchor" href="#arg-segments"></a></dt>
<dd><p>A data.table containing the output from vecshift().
Must include 'id' column for merging.</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>Character vector specifying which columns from original_data
to merge into segments. Column names must exist in original_data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.table combining the segments data with the requested columns
  from original_data. The temporal ordering and structure of segments is
  preserved. Unemployment periods (id = 0) are included but without the
  merged columns.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs an inner join between the segments data and the
original contract data using the 'id' column as the key. Since vecshift()
creates multiple temporal segments from single contracts, the same original
contract data may appear in multiple segment rows.</p>
<p>Unemployment periods (where id = 0) are preserved but will not have
merged columns from the original data, as they don't correspond to
specific contracts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create sample employment data with additional metadata</span></span></span>
<span class="r-in"><span><span class="va">original_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>  cf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABC123"</span>, <span class="st">"ABC123"</span>, <span class="st">"DEF456"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  INIZIO <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-01-01"</span>, <span class="st">"2023-06-01"</span>, <span class="st">"2023-02-01"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  FINE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-05-31"</span>, <span class="st">"2023-12-31"</span>, <span class="st">"2023-11-30"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  company <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CompanyA"</span>, <span class="st">"CompanyB"</span>, <span class="st">"CompanyC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span>, <span class="fl">25000</span>, <span class="fl">60000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  department <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IT"</span>, <span class="st">"HR"</span>, <span class="st">"Finance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform to temporal segments</span></span></span>
<span class="r-in"><span><span class="va">segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="vecshift.html">vecshift</a></span><span class="op">(</span><span class="va">original_dt</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Merge additional columns</span></span></span>
<span class="r-in"><span><span class="va">enriched</span> <span class="op">&lt;-</span> <span class="fu">merge_original_columns</span><span class="op">(</span></span></span>
<span class="r-in"><span>  original_data <span class="op">=</span> <span class="va">original_dt</span>,</span></span>
<span class="r-in"><span>  segments <span class="op">=</span> <span class="va">segments</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"company"</span>, <span class="st">"salary"</span>, <span class="st">"department"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">enriched</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Merge single column</span></span></span>
<span class="r-in"><span><span class="va">with_company</span> <span class="op">&lt;-</span> <span class="fu">merge_original_columns</span><span class="op">(</span></span></span>
<span class="r-in"><span>  original_data <span class="op">=</span> <span class="va">original_dt</span>,</span></span>
<span class="r-in"><span>  segments <span class="op">=</span> <span class="va">segments</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="st">"company"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gmontaletti" class="external-link">Giampaolo Montaletti</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

