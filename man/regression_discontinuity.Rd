% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impact_rdd.R
\name{regression_discontinuity}
\alias{regression_discontinuity}
\title{Main Regression Discontinuity Design Estimation}
\usage{
regression_discontinuity(
  data,
  outcome,
  running_variable,
  cutoff = 0,
  treatment_variable = NULL,
  design = "sharp",
  bandwidth_method = "mserd",
  bandwidth_value = NULL,
  kernel = "triangular",
  polynomial_order = 1,
  bias_correction = TRUE,
  robust_inference = TRUE,
  cluster_variable = NULL,
  covariates = NULL,
  alpha = 0.05
)
}
\arguments{
\item{data}{A data.table or data.frame containing the analysis dataset}

\item{outcome}{Character string specifying the outcome variable name}

\item{running_variable}{Character string specifying the running variable name}

\item{cutoff}{Numeric value specifying the cutoff point (default: 0)}

\item{treatment_variable}{Character string specifying treatment variable name (for fuzzy RDD)}

\item{design}{Character string: "sharp" or "fuzzy" RDD design (default: "sharp")}

\item{bandwidth_method}{Character string: "mserd" (mean squared error), "cerrd" (coverage error), or "manual"}

\item{bandwidth_value}{Numeric value for manual bandwidth selection (ignored if bandwidth_method != "manual")}

\item{kernel}{Character string: "triangular", "rectangular", or "epanechnikov" (default: "triangular")}

\item{polynomial_order}{Integer specifying polynomial order (default: 1, recommended: 1-2)}

\item{bias_correction}{Logical indicating whether to apply bias correction (default: TRUE)}

\item{robust_inference}{Logical indicating whether to use robust standard errors (default: TRUE)}

\item{cluster_variable}{Character string specifying cluster variable for clustered standard errors}

\item{covariates}{Character vector of covariate names to include (optional)}

\item{alpha}{Numeric value for confidence level (default: 0.05 for 95% CI)}
}
\value{
A list containing:
\describe{
  \item{estimates}{Data.table with treatment effect estimates}
  \item{bandwidth}{Selected or specified bandwidth}
  \item{sample_sizes}{Sample sizes within bandwidth}
  \item{first_stage}{First stage results (fuzzy RDD only)}
  \item{diagnostics}{Model diagnostics and fit statistics}
  \item{method_details}{Details of estimation method and parameters}
}
}
\description{
Performs regression discontinuity design estimation with automatic bandwidth selection
and supports both sharp and fuzzy RDD designs. Includes bias-corrected estimates
and robust inference procedures.
}
\details{
The function implements local polynomial regression around the cutoff with optimal
bandwidth selection following Calonico et al. (2014). For fuzzy RDD, it uses
two-stage least squares with the assignment rule as instrument.

Bandwidth selection methods:
- "mserd": Minimizes mean squared error of the RDD estimator
- "cerrd": Minimizes coverage error of confidence intervals
- "manual": Uses user-specified bandwidth

The function provides bias-corrected estimates using higher-order polynomials
following Calonico et al. (2014) robust bias-correction procedure.
}
\examples{
\dontrun{
# Sharp RDD
rdd_results <- regression_discontinuity(
  data = employment_data,
  outcome = "employment_rate",
  running_variable = "age",
  cutoff = 65,
  design = "sharp"
)

# Fuzzy RDD with covariates
fuzzy_results <- regression_discontinuity(
  data = employment_data,
  outcome = "earnings",
  running_variable = "test_score",
  treatment_variable = "program_participation",
  cutoff = 70,
  design = "fuzzy",
  covariates = c("age", "gender", "education")
)
}

}
\references{
Calonico, S., Cattaneo, M. D., & Titiunik, R. (2014). Robust nonparametric confidence
intervals for regression-discontinuity designs. Econometrica, 82(6), 2295-2326.

Imbens, G. W., & Lemieux, T. (2008). Regression discontinuity designs: A guide to practice.
Journal of Econometrics, 142(2), 615-635.
}
