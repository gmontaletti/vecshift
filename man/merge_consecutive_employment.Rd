% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/merge_consecutive_employment.R
\name{merge_consecutive_employment}
\alias{merge_consecutive_employment}
\title{Collapse Consecutive Employment Periods}
\usage{
merge_consecutive_employment(dt)
}
\arguments{
\item{dt}{A data.table output from vecshift() containing temporal segments with columns:
\itemize{
  \item{\code{cf}}: Person identifier
  \item{\code{inizio}}: Segment start date
  \item{\code{fine}}: Segment end date  
  \item{\code{arco}}: Number of overlapping contracts (0 = unemployment)
  \item{\code{prior}}: Employment type (numeric)
  \item{Additional columns}: Any other contract parameters (numeric or character)
}}
}
\value{
A data.table with collapsed consecutive employment periods containing:
  \itemize{
    \item{\code{cf}}: Person identifier
    \item{\code{inizio}}: Period start date
    \item{\code{fine}}: Period end date
    \item{\code{arco}}: Number of overlapping contracts (preserved for unemployment)
    \item{\code{prior}}: Mean priority for collapsed periods
    \item{Character columns}: Concatenated as "first->last" for collapsed periods
    \item{Numeric columns}: Mean value for collapsed periods
    \item{Numeric columns with "_direction" suffix}: Direction of change (last - first)
    \item{\code{durata}}: Duration of the period in days
    \item{\code{collapsed}}: Logical indicating if period was collapsed (TRUE) or not (FALSE)
  }
}
\description{
Collapses consecutive working periods (where arco > 0) into single segments for each person.
Consecutive periods are merged into one with the first start date and last end date,
maintaining unemployment periods and single-line contracts unchanged.
}
\examples{
\dontrun{
library(data.table)
# Create sample output from vecshift
dt <- data.table(
  cf = c("A", "A", "A", "A", "B", "B"),
  inizio = as.Date(c("2023-01-01", "2023-02-01", "2023-02-15", "2023-04-01", 
                     "2023-01-01", "2023-03-01")),
  fine = as.Date(c("2023-01-31", "2023-02-14", "2023-03-31", "2023-04-30",
                   "2023-02-28", "2023-03-31")),
  arco = c(1, 0, 1, 1, 1, 0),
  prior = c(1, 0, 0.5, 1, 1, 0),
  contract_type = c("FT", NA, "PT", "FT", "FT", NA),
  salary = c(3000, NA, 1500, 3200, 2800, NA)
)

# Collapse consecutive employment periods
result <- merge_consecutive_employment(dt)
print(result)
}
}
