% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_employment_transitions.R
\name{analyze_consolidated_periods}
\alias{analyze_consolidated_periods}
\title{Analyze Consolidated Employment Periods Using over_id}
\usage{
analyze_consolidated_periods(
  segments,
  level = "both",
  include_unemployment = TRUE,
  consolidation_type = "both",
  min_employment_duration = 1,
  include_details = TRUE
)
}
\arguments{
\item{segments}{Input data from vecshift() with over_id column. Must be a data.table
with required columns: cf, inizio, fine, arco, durata, over_id, and optionally
additional employment attributes for detailed analysis.}

\item{level}{Character string specifying analysis granularity:
\itemize{
  \item{\code{"person"}}: Person-level analysis with individual statistics
  \item{\code{"aggregate"}}: Population-level aggregate statistics
  \item{\code{"both"}}: Both person and aggregate analysis (default)
}}

\item{include_unemployment}{Logical. If TRUE (default), includes unemployment periods
(over_id = 0) in the analysis. If FALSE, focuses only on employment consolidation.}

\item{consolidation_type}{Character string specifying consolidation approach for comparison:
\itemize{
  \item{\code{"both"}}: Compare against both overlapping and consecutive consolidation (default)
  \item{\code{"overlapping"}}: Compare against overlapping consolidation only
  \item{\code{"employment_only"}}: Focus on employment periods only, ignore unemployment
}}

\item{min_employment_duration}{Minimum duration (days) for employment periods to include
in analysis (default: 1). Helps filter out very short-term contracts.}

\item{include_details}{Logical. If TRUE (default), includes detailed breakdowns and
comparisons. If FALSE, returns only summary statistics for performance.}
}
\value{
When \code{level} is "person" or "both", returns a list containing:
  \itemize{
    \item{\code{person_analysis}}: data.table with person-level statistics including:
      \itemize{
        \item{\code{cf}}: Person identifier
        \item{\code{total_periods_original}}: Count of original vecshift segments
        \item{\code{total_periods_consolidated}}: Count of consolidated periods (unique over_id)
        \item{\code{employment_periods_original}}: Employment segments (arco >= 1)
        \item{\code{employment_periods_consolidated}}: Consolidated employment periods (over_id > 0)
        \item{\code{unemployment_periods}}: Unemployment segments (over_id = 0)
        \item{\code{consolidation_ratio}}: Reduction in period count (1 - consolidated/original)
        \item{\code{employment_complexity_avg}}: Average arco for employment periods
        \item{\code{max_simultaneous_jobs}}: Maximum concurrent employment (max arco)
        \item{\code{total_employment_days_original}}: Sum of original employment durations
        \item{\code{total_employment_days_consolidated}}: Sum of consolidated employment durations
        \item{\code{avg_employment_duration_original}}: Mean duration of original employment segments
        \item{\code{avg_employment_duration_consolidated}}: Mean duration of consolidated periods
        \item{\code{duration_efficiency}}: Duration consistency (consolidated/original ratio)
        \item{\code{overlapping_episodes}}: Count of over_id periods with multiple contracts
      }
    \item{\code{aggregate_analysis}}: data.table with population-level summary statistics
    \item{\code{consolidation_benefits}}: data.table showing consolidation impact analysis
    \item{\code{employment_complexity}}: data.table with employment complexity patterns
  }
  
  When \code{level} is "aggregate", returns only the aggregate analysis components.
  
  All results include attributes:
  \itemize{
    \item{\code{analysis_parameters}}: Analysis configuration used
    \item{\code{validation_results}}: Data validation and quality checks
    \item{\code{computation_time}}: Time taken for analysis
  }
}
\description{
Provides comprehensive analysis of consolidated employment periods leveraging the over_id 
functionality from vecshift() output. This function analyzes employment periods grouped by 
over_id to understand the benefits and patterns of employment consolidation, comparing
individual contracts to consolidated employment episodes.
}
\details{
The over_id column from vecshift() identifies continuous overlapping employment periods:
\itemize{
  \item \strong{over_id = 0}: Unemployment periods (no active contracts)
  \item \strong{over_id > 0}: Employment periods with same value for overlapping/continuous contracts
  \item \strong{Same over_id}: All contracts belonging to same continuous overlapping time period
}

This function provides insights into:
\itemize{
  \item \strong{Consolidation Benefits}: How much employment history is simplified
  \item \strong{Employment Complexity}: Patterns of multiple simultaneous jobs
  \item \strong{Administrative Efficiency}: Time savings from consolidated view
  \item \strong{Employment Patterns}: Duration and frequency of consolidated vs individual periods
}
}
\examples{
\dontrun{
library(data.table)

# Create sample employment data with overlapping periods
employment_data <- data.table(
  id = 1:8,
  cf = c(rep("PERSON001", 5), rep("PERSON002", 3)),
  INIZIO = as.Date(c("2023-01-01", "2023-03-01", "2023-03-15", "2023-06-01", "2023-08-01",
                     "2023-02-01", "2023-05-01", "2023-07-01")),
  FINE = as.Date(c("2023-02-28", "2023-03-31", "2023-05-31", "2023-07-31", "2023-12-31",
                   "2023-04-30", "2023-06-30", "2023-12-31")),
  prior = c(1, 0, 1, 1, 1, 1, 0, 1),
  company = c("CompanyA", "CompanyB", "CompanyA", "CompanyC", "CompanyD",
              "CompanyE", "CompanyF", "CompanyG"),
  salary = c(50000, 25000, 52000, 60000, 55000, 45000, 30000, 65000)
)

# Apply vecshift to get segments with over_id
segments <- vecshift(employment_data)

# Comprehensive analysis with both person and aggregate levels
analysis_full <- analyze_consolidated_periods(
  segments = segments,
  level = "both",
  include_unemployment = TRUE,
  consolidation_type = "both",
  include_details = TRUE
)

# View person-level results
print(analysis_full$person_analysis)
print(analysis_full$consolidation_benefits)

# View aggregate statistics
print(analysis_full$aggregate_analysis)
print(analysis_full$employment_complexity)

# Focus on employment consolidation only
analysis_employment <- analyze_consolidated_periods(
  segments = segments,
  level = "aggregate",
  include_unemployment = FALSE,
  consolidation_type = "employment_only",
  min_employment_duration = 7
)
print(analysis_employment$aggregate_analysis)

# Person-level analysis for detailed insights
analysis_person <- analyze_consolidated_periods(
  segments = segments,
  level = "person",
  consolidation_type = "overlapping"
)
print(analysis_person$person_analysis)

# Check analysis parameters and validation
print(attr(analysis_full, "analysis_parameters"))
print(attr(analysis_full, "validation_results"))
}
}
